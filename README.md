## Overview
This repo contains the necessary scripts and instructions to reproduce the figures in the 20.440 final written report.

Endometriosis is a common and morbid disease that affects approximately 10-15% of reproductive-age women worldwide. 
The disease is characterized by deposits of endometrium-like tissue outside of the endometrium lining which grows and sheds throughout the menstrual cycle.
Despite its prevalence, diagnosis remains challenging and can take up to 10 years since symptoms are often similar to other pathologies such as cancer. 
The current standard of cancer diagnosis is highly accurate where well-defined biomarkers from biopsies are used to inform specific treatment regimens for unique cancer subtypes (triple negative, HER2 positive, etc.). 
The current standard of endometriosis diagnosis is limited to laparoscopy since there are no well-defined biomarkers for endometriosis subtypes.
Our study aims to identify candidate diagnostic biomarkers of the most common form of endometriosis (endometrioma) to allow the incorporation of biopsies into the standard endometriosis diagnostic workflow.
In aim 1 of our project, we leverage publicly available single-cell RNA sequencing (scRNA-seq) data from Fonseca et al. to characterize transcriptomic differences between endometrioma and healthy ovarian epithelial cells.

## Data
In this study, we analyze the transcriptome of ovarian epithelial cells using a single-cell transcriptomic atlas of human endometriosis generated by Fonseca et al. 2023 [6]. 
In this aforementioned study, the authors profiled the transcriptomics of >370,000 individual cells from endometriomas (n=8), endometriosis (n=28), unaffected ovary (n=4), and endometriosis-free peritoneum (n=4) from a total of 21 different patients to generate a cellular atlas of endometrial-type epithelial cells, stromal cells, and additional cell populations. 
We extend the analysis performed in Fonseca et al. by delving deeper into the subset of epithelial cells in endometrioma and unaffected ovaries. 

scRNA-seq of endometrial samples were generated using Illumina 10xv3 Chemistry on a NovaSeq S4 and posted to the GEO database for public use [2][3].

Single cells were captured and barcoded using the 10X Chromium platform. ScRNA-seq libraries were prepared following the Chromium Single Cell 3' Reagent Kits User Guide (v2/v3). Gel Bead-In Emulsions were generated using single cell preparations. Libraries were quantified using Agilent Bioanalyzer High Sensitivity DNA chips and pooled together before sequencing on a NovaSeq S4.

GEO Asscession URL:
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE213216

GEO Samples used:

- GSM6574518
- GSM6574519
- GSM6574520
- GSM6574521
- GSM6574528
- GSM6574529
- GSM6574530
- GSM6574531

Also see references section for citations.

The data is also described in the meta data of the GSM page and in the csv located in the Data folder of this repository. The data being used are single-cell RNA sequencing samples from [2][3], studying the single-cell transcriptome in endometriosis. We are currently focusing on 8 samples split between 2 individuals (each individual with 2 endometrial samples and 2 control samples).

Data Characteristics in Short:
- Tissue samples from female donors
- 2 patients
- 7 unique anatomical locations
- 3 major classes (endometriosis, no endometriosis, eutopic endometrium)

## Folder structure
`Cluster_scripts` contains shell scripts used to download fastqs from Sequence Read Archive (SRA) and process them into spliced/unspliced count matrices. These files are relevant to our final project, but are not used to generate a figure for Pset 6.

`Data` contains a csv file with the GEO acession ids for the 8 samples used in the violin plot for Pset 6.

`Figures` contains a png of the mitochondrial violin plot figure for Pset 6.

`R_scripts` contains the R script used to generate the mitochondrial violin plot figure for Pset 6.

## Installation
How do I run your code?
1. Download the required data files from the GEO database and unzip them
2. Download the R script file (`Endo_Analysis.R`)
3. Install R studio or some other means of running R code
4. Modify the paths in `Endo_Analysis.R` to match your preferred local file structure
5. Run the code (make sure to install libraries which you are missing)
What software and package versions do I need to install?

Seurat Installation:

`install.packages('Seurat')`
`#enter 'y' if any warnings pop up`

splitstackshape Installation:

`install.packages("splitstackshape")`

ggplot2 Installation:

`install.packages("ggplot2")`

R version 4.2.1

RStudio Version 2023.12.0+369 (2023.12.0+369)

## References

1. Y. Hao et al., “Dictionary learning for integrative, multimodal and scalable single-cell analysis,” Nat Biotechnol, vol. 42, no. 2, pp. 293–304, Feb. 2024, doi: 10.1038/s41587-023-01767-y.

2. Fonseca MAS, Haro M, Wright KN, Lin X et al. Single-cell transcriptomic analysis of endometriosis. Nat Genet 2023 Feb;55(2):255-267. PMID: 36624343

3. Pei FL, Jia JJ, Lin SH, Chen XX et al. Construction and evaluation of endometriosis diagnostic prediction model and immune infiltration based on efferocytosis-related genes. Front Mol Biosci 2023;10:1298457. PMID: 38370978


